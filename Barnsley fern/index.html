<!DOCTYPE html>
<html>
<head>
  <title>Barnsley fern</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.2/css/foundation.css">
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.2/js/foundation.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.js"></script>

</head>
<!-- <body onload="draw(x,y,radius)"> -->
<body>
  <div class="container">

    <div class="col-md-8">
      <h1>Barnsley fern</h1>
      <p>Implementing Barnsley fern using JavaScript.</p>
      <!-- <div class="col-md-4">
      <textarea class="form-control" maxlength="4" onfocus="this.value=''; this.onfocus='';" style="background:#ffffff; color:#000000; resize:none" rows="1" id="circle">Enter radius</textarea>
      </div> -->
      <!-- <button type="button" class="btn btn-primary" onclick="clean(); factorial($('#circle').val());">Draw</button> -->
      <!-- <button type="button" class="btn btn-primary" onclick="clean()">Clear</button> -->
    </div>
    <div class="container">

      <div class="col-md-8">
      <!-- <span id="mySlider"></span> -->
      <span id="mySlider"></span>
      <!-- <input type="number" id="mySlider" style="margin-top:7px;" value="72"> -->
      <!-- <div class="range-slider round" data-slider data-options="display_selector: #mySlider; start: 0.001; end: 0.020; step: 0.001">
        <span class="range-slider-handle"></span>
        <span class="range-slider-active-segment"></span>
      </div> -->
</div>


      <div class="col-md-8">
        <div class="row">
          <hr>
      <canvas id="myCanvas" width="900" height="500" style="border:1px solid #d3d3d3;">
      </div>
      </div>
    </div>
  </div>
</div>

<script>
$(document).ready(function() {
    $(document).foundation();
})

var n;
var a = 0; var b = 0; var radius;
clean();
 barnsley(a,b);

$('[data-slider]').on('change.fndtn.slider', function(){
         var value = $(this).attr('data-slider');
        //  clean();
        //  barnsley(a,b,value);
        }


    );


    function clean(){
      console.log("testing");
      var c=document.getElementById("myCanvas");
      var ctx=c.getContext("2d");
      ctx.clearRect(0, 0, 900, 500);
    }


    function barnsley(a,b) {

      var c = document.getElementById("myCanvas");
      var ctx = c.getContext("2d");
      // ctx.fillStyle = 'green';
      ctx.translate(ctx.canvas.width / 2, ctx.canvas.height);


        for (var i = 0; i < 10000; i++) {
          var rand = Math.random() * 100;
          if (rand < 1) {
            fern1();
          } else if (rand < 86) {
            fern2();
          } else if (rand < 94) {
            fern3();
          } else {
            fern4();
          }
        }


      function fern1() {
        var xn = a;
        var yn = b;
        var zx = 0;
        var zy = 0.16 * yn;
        draw(zx, zy);
      }

      function fern2() {
        var xn = a;
        var yn = b;
        // var xrand = Math.floor(Math.random() * (2 + 2 + 1)) -2;
        // console.log(xrand);
        var zx =  0.87  * xn + 0.09 * yn;
        var zy = -0.04 * xn + 0.85 * yn + 1.6;
        draw(zx, zy);
      }

      function fern3() {
        var xn = a;
        var yn = b;
        var zx = 0.2 * xn - 0.26 * yn;
        var zy = 0.23 * xn + 0.22 * yn + 1.6;
        draw(zx, zy);
      }

      function fern4() {
        var xn = a;
        var yn = b;
        var zx = -0.15 * xn + 0.28 * yn;
        var zy = 0.26 * xn + 0.24 * yn + 0.44;
        draw(zx, zy);
      }

      function draw(xn, yn) {
        a = xn;
        b = yn;
        ctx.fillStyle = 'red';
        // ctx.beginPath();
        // ctx.arc(x, y, radius, 0, 2 * Math.PI);
        // ctx.fillStyle = '#'+(Math.random()*0xFFFF33<<0).toString(16);
        // ctx.fill();
        // ctx.stroke();
        // ctx.closePath();
        ctx.fillRect(xn * 20, -yn * 20, 1, 1);
      }

    }


</script>

</body>
</html>
